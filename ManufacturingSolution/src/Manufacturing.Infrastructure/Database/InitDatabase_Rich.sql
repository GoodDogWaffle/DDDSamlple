-- Rich initialization script

CREATE TABLE ProductionPlans (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    PlannedDate DATETIME2 NOT NULL,
    PlantCapacity INT NOT NULL
);

CREATE TABLE WorkOrders (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    ScheduledStart DATETIME2 NOT NULL,
    Status INT NOT NULL
);

CREATE TABLE Orders (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    CustomerId UNIQUEIDENTIFIER NOT NULL,
    OrderDate DATETIME2 NOT NULL,
    CreditLimit DECIMAL(18,2) NOT NULL
);

CREATE TABLE OrderLines (
    OrderId UNIQUEIDENTIFIER NOT NULL,
    ItemId UNIQUEIDENTIFIER NOT NULL,
    Quantity INT NOT NULL,
    UnitPrice DECIMAL(18,2) NOT NULL,
    CONSTRAINT FK_OrderLines_Orders FOREIGN KEY (OrderId) REFERENCES Orders(Id)
);

CREATE TABLE PurchaseOrders (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    CreatedDate DATETIME2 NOT NULL,
    ExpectedArrival DATETIME2 NOT NULL,
    Received BIT NOT NULL
);

CREATE TABLE InventoryItems (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    Quantity INT NOT NULL,
    ReorderThreshold INT NOT NULL
);

CREATE TABLE StocktakeSessions (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    SessionDate DATETIME2 NOT NULL
);

CREATE TABLE StocktakeLines (
    SessionId UNIQUEIDENTIFIER NOT NULL,
    ItemId UNIQUEIDENTIFIER NOT NULL,
    CountedQuantity INT NOT NULL,
    SystemQuantity INT NOT NULL,
    CONSTRAINT FK_StocktakeLines_Sessions FOREIGN KEY (SessionId) REFERENCES StocktakeSessions(Id)
);

CREATE TABLE JournalEntries (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    EntryDate DATETIME2 NOT NULL,
    Amount DECIMAL(18,2) NOT NULL,
    Type INT NOT NULL,
    Description NVARCHAR(256) NOT NULL
);

-- Seed data
INSERT INTO InventoryItems VALUES
('00000000-0000-0000-0000-000000000001', 100, 20),
('00000000-0000-0000-0000-000000000002', 50, 10);

INSERT INTO ProductionPlans VALUES
('00000000-0000-0000-0000-000000000010', '2025-06-01', 200);

INSERT INTO Orders VALUES
('00000000-0000-0000-0000-000000000100', '11111111-1111-1111-1111-111111111111', '2025-05-24', 1000.00);

INSERT INTO OrderLines VALUES
('00000000-0000-0000-0000-000000000100', '00000000-0000-0000-0000-000000000001', 5, 10.00);

INSERT INTO PurchaseOrders VALUES
('00000000-0000-0000-0000-000000000200', '2025-05-01', '2025-05-10', 0);

-- Customer マスタ
CREATE TABLE Customers (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    Name NVARCHAR(100) NOT NULL,
    CreditLimit DECIMAL(18,2) NOT NULL
);
INSERT INTO Customers VALUES
('11111111-1111-1111-1111-111111111111','大手商社',10000.00);

-- PricingRules マスタ
CREATE TABLE PricingRules (
    Id UNIQUEIDENTIFIER PRIMARY KEY,
    ItemId UNIQUEIDENTIFIER NOT NULL,
    Discount DECIMAL(5,2) NOT NULL
);
INSERT INTO PricingRules VALUES
('22222222-2222-2222-2222-222222222222','00000000-0000-0000-0000-000000000001',0.10);
